# 软件安装

## 🎯 目标
安装智能客服系统开发所需的所有软件工具。

## 📦 需要安装的软件
- Docker & Docker Compose
- Python 3.11+
- Node.js 18+
- Git

## 🔧 安装步骤

### 1. 安装Docker和Docker Compose

#### Ubuntu/Debian
```bash
# 更新包索引
sudo apt update

# 安装必要的包
sudo apt install apt-transport-https ca-certificates curl gnupg lsb-release

# 添加Docker官方GPG密钥
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg

# 添加Docker仓库
echo "deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# 安装Docker
sudo apt update
sudo apt install docker-ce docker-ce-cli containerd.io docker-compose-plugin

# 将用户添加到docker组
sudo usermod -aG docker $USER
```

#### macOS
```bash
# 使用Homebrew安装
brew install docker docker-compose

# 或下载Docker Desktop
# https://www.docker.com/products/docker-desktop
```

#### CentOS/RHEL
```bash
# 安装Docker
sudo yum install -y yum-utils
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
sudo yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin

# 启动Docker服务
sudo systemctl start docker
sudo systemctl enable docker
sudo usermod -aG docker $USER
```

### 2. 安装Python 3.11+

#### Ubuntu/Debian
```bash
# 添加deadsnakes PPA
sudo apt update
sudo apt install software-properties-common
sudo add-apt-repository ppa:deadsnakes/ppa

# 安装Python 3.11
sudo apt update
sudo apt install python3.11 python3.11-venv python3.11-dev python3-pip
```

#### macOS
```bash
# 使用Homebrew
brew install python@3.11

# 或使用pyenv
brew install pyenv
pyenv install 3.11.0
pyenv global 3.11.0
```

#### CentOS/RHEL
```bash
# 编译安装Python 3.11
sudo yum groupinstall "Development Tools"
sudo yum install openssl-devel bzip2-devel libffi-devel

wget https://www.python.org/ftp/python/3.11.0/Python-3.11.0.tgz
tar xzf Python-3.11.0.tgz
cd Python-3.11.0
./configure --enable-optimizations
make altinstall
```

### 3. 安装Node.js 18+

#### 使用NodeSource仓库 (推荐)
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# CentOS/RHEL
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs
```

#### macOS
```bash
# 使用Homebrew
brew install node@18

# 或使用nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 18
nvm use 18
```

### 4. 安装Git
```bash
# Ubuntu/Debian
sudo apt install git

# CentOS/RHEL
sudo yum install git

# macOS
brew install git
```

## ✅ 验证安装

创建验证脚本 `verify_installation.sh`：

```bash
#!/bin/bash
echo "=== 软件安装验证 ==="

# 检查Docker
if command -v docker &> /dev/null; then
    DOCKER_VERSION=$(docker --version)
    echo "✅ Docker: $DOCKER_VERSION"
else
    echo "❌ Docker未安装"
fi

# 检查Docker Compose
if docker compose version &> /dev/null; then
    COMPOSE_VERSION=$(docker compose version)
    echo "✅ Docker Compose: $COMPOSE_VERSION"
else
    echo "❌ Docker Compose未安装"
fi

# 检查Python
if command -v python3.11 &> /dev/null; then
    PYTHON_VERSION=$(python3.11 --version)
    echo "✅ Python: $PYTHON_VERSION"
elif command -v python3 &> /dev/null; then
    PYTHON_VERSION=$(python3 --version)
    if [[ $PYTHON_VERSION == *"3.11"* ]] || [[ $PYTHON_VERSION == *"3.12"* ]]; then
        echo "✅ Python: $PYTHON_VERSION"
    else
        echo "❌ Python版本不符合要求 (需要3.11+): $PYTHON_VERSION"
    fi
else
    echo "❌ Python未安装"
fi

# 检查Node.js
if command -v node &> /dev/null; then
    NODE_VERSION=$(node --version)
    echo "✅ Node.js: $NODE_VERSION"
else
    echo "❌ Node.js未安装"
fi

# 检查npm
if command -v npm &> /dev/null; then
    NPM_VERSION=$(npm --version)
    echo "✅ npm: $NPM_VERSION"
else
    echo "❌ npm未安装"
fi

# 检查Git
if command -v git &> /dev/null; then
    GIT_VERSION=$(git --version)
    echo "✅ Git: $GIT_VERSION"
else
    echo "❌ Git未安装"
fi

echo "=== 验证完成 ==="
```

运行验证：
```bash
chmod +x verify_installation.sh
./verify_installation.sh
```

## 🔧 权限配置

### Docker权限配置
```bash
# 重新登录以使docker组生效，或运行：
newgrp docker

# 测试Docker权限
docker run hello-world
```

### Python权限配置
```bash
# 确保pip可以正常使用
python3.11 -m pip --version
```

## 🚨 常见问题

### Docker权限问题
```bash
# 如果遇到权限拒绝错误
sudo usermod -aG docker $USER
# 然后重新登录或运行
newgrp docker
```

### Python版本问题
```bash
# 如果系统有多个Python版本，创建软链接
sudo ln -sf /usr/bin/python3.11 /usr/bin/python3
```

### Node.js版本问题
```bash
# 使用nvm管理Node.js版本
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
source ~/.bashrc
nvm install 18
nvm alias default 18
```

## ➡️ 下一步
软件安装完成后，继续 [项目初始化](./项目初始化.md)